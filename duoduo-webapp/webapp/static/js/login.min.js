$.namespace("Mo.Login"),Mo.Login={init:function(){this.initEvent()},initEvent:function(){$(".arrow-down",".item-setting-language").bind("click",function(){$(".item-language-list").show()}),$(document).bind("click",function(e){var i=$(e.target);0==i.closest(".arrow-down").length&&0==i.closest(".item-language-list").length&&($(".item-language-list").hide(),$(".setting-language").removeClass("select"))}),$(".setting-language",".ul-language-list").bind("click",function(){var e=$(this).attr("vId");$(".current-language").text($(this).attr("value")),$.ajax({type:"post",url:Mo.Base.getAppUrl()+"/changeLocale",data:{locale:e},dataType:"json",success:function(e){e.success||alert(e.description),location.href=Mo.Base.getAppUrl()+"/login"},error:function(){location.href=Mo.Base.getAppUrl()+"/login"}})}).mouseover(function(){$(this).hasClass("select")||($(".setting-language").removeClass("select"),$(this).addClass("select"))}),$(".forgot-password").bind("click",function(){Mo.Login.showForgotPassword()}),$(".W_close","#forgotPassword-wrapper").bind("click",function(){Mo.Login.showLogin()}),$("#account").keydown(function(e){if(13==e.keyCode)return $("#loginBtn").click(),!1;var i=$(".reg-label",".item-account");i.hide()}).blur(function(){var e=$(".reg-label",".item-account"),i=$("#account").val();""==$.trim(i)&&(e.show(),$("#account").val(""))}),$("#password").keydown(function(e){if(13==e.keyCode)return $("#loginBtn").click(),!1;var i=$(".reg-label",".item-password");i.hide()}).blur(function(){var e=$(".reg-label",".item-password"),i=$("#password").val();""==i&&(e.show(),$("#password").val(""))}),$("#verifyCode").keydown(function(e){if(13==e.keyCode)return $("#loginBtn").click(),!1;var i=$(".reg-label",".item-verifyCode");i.hide()}).blur(function(){var e=$(".reg-label",".item-verifyCode"),i=$("#verifyCode").val();""==$.trim(i)&&(e.show(),$("#verifyCode").val(""))}),$("#loginBtn").bind("click",function(){if(Mo.Base.throttle.isLock("/login"))return!1;Mo.Base.throttle.lock("/login"),Mo.Login.hideLoginMsg();var e=Mo.Login.checkData();return e&&null!=e?($.ajax({type:"post",url:Mo.Base.getAppUrl()+"/login",data:e,dataType:"json",success:function(e){e.success?location.href=Mo.Base.getAppUrl()+"/home":(Mo.Login.showLoginMsg(e.description),$("#verifyImage").click(),Mo.Login.showVerifyCode()),Mo.Base.throttle.unLock("/login")},error:function(){$("#verifyImage").click(),Mo.Login.showVerifyCode(),Mo.Login.showLoginMsg($lang.login_login_msg_ajax_error),Mo.Base.throttle.unLock("/login")}}),void 0):(Mo.Base.throttle.unLock("/login"),!1)}),$("#verifyImage").bind("click",function(){document.getElementById("verifyImage").src=Mo.Base.getAppUrl()+"/verifyCodeImage?random="+(new Date).getTime()}),$("#reg-email").keydown(function(){var e=$(".reg-label",".item-reg-email");e.hide()}).blur(function(){var e=$(".reg-label",".item-reg-email"),i=$("#reg-email").val();""==$.trim(i)&&(e.show(),$("#reg-email").val(""))}),$("#forgotPasswordBtn").bind("click",function(){var e=$("#reg-email").val();return""==$.trim(e)?(Mo.Login.showForgotPasswordMsg($lang.login_forgot_msg_regEmail_empty),!1):void 0})},checkData:function(){var e={account:$("#account").val(),password:$("#password").val(),verifyCode:$("#verifyCode").val()};if(""==$.trim(e.account))return Mo.Login.showLoginMsg($lang.login_login_msg_account_empty),$("#account").focus(),!1;if(""==$.trim(e.password))return Mo.Login.showLoginMsg($lang.login_login_msg_password_empty),$("#password").focus(),!1;if($(".item-verifyCode").hasClass("hidden"))e.enableVerifyCode="0";else if(e.enableVerifyCode="1",""==$.trim(e.verifyCode))return Mo.Login.showLoginMsg($lang.login_login_msg_verifyCode_empty),$("#verifyCode").focus(),!1;return e},showLogin:function(){$("#login-wrapper").show(),$("#account").focus(),$("#forgotPassword-wrapper").hide(),$("#reg-email").val(""),$(".reg-label",".item-reg-email").show(),Mo.Login.hideForgotPasswordMsg()},showForgotPassword:function(){$("#login-wrapper").hide(),$("#forgotPassword-wrapper").show(),$("#reg-email").focus(),$("#account").val(""),$(".reg-label",".item-account").show(),$("#password").val(""),$(".reg-label",".item-password").show(),$("#verifyCode").val(""),$(".reg-label",".item-verifyCode").show(),Mo.Login.hideLoginMsg()},showLoginMsg:function(e){$(".msg","#login-wrapper").text(e),$(".msg-div","#login-wrapper").show()},hideLoginMsg:function(){$(".msg-div","#login-wrapper").hide(),$(".msg","#login-wrapper").text("")},showForgotPasswordMsg:function(e){$(".msg","#forgotPassword-wrapper").text(e),$(".msg-div","#forgotPassword-wrapper").show()},hideForgotPasswordMsg:function(){$(".msg-div","#forgotPassword-wrapper").hide(),$(".msg","#forgotPassword-wrapper").text("")},showVerifyCode:function(){$(".item-verifyCode").hasClass("hidden")&&$(".item-verifyCode").removeClass("hidden")},hideVerifyCode:function(){if(!$(".item-verifyCode").hasClass("hidden")){$(".item-verifyCode").addClass("hidden"),$("#verifyCode").val("");var e=$(".reg-label",".item-verifyCode");e.hasClass("hidden")&&e.removeClass("hidden")}}};
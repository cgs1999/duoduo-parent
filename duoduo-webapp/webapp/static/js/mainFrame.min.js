$.namespace("Mo.Frame"),Mo.Frame={default_detail_paddingTop:56,default_detail_paddingLeft:244,detail_paddingTop:this.default_detail_paddingTop,detail_paddingLeft:this.default_detail_paddingLeft,main_min_width:1280,main_padding_left:128,main_min_height:642,main_padding_bottom:68,main_top_height:98,fixLineHeight:2,init:function(){this.setSize(),this.initEvent()},initEvent:function(){var e=this;$(window).resize(function(){e.setSize()})},setSize:function(){var e=this.getWindowSize();e.w<this.main_min_width&&(e.w=this.main_min_width),e.h<this.main_min_height&&(e.h=this.main_min_height);var i=e.w-2*this.main_padding_left;e.h,$(".wrap-all").width(i),$(".wrap-all").height(e.h);var t=e.h-this.main_top_height-this.main_padding_bottom;$("#inner-main").height(t);var o=t-2*this.fixLineHeight;$("#main-content").height(o),$("#detail-content").css("top",this.detail_paddingTop+this.fixLineHeight),$("#detail-content").height(o-this.detail_paddingTop);var a=$("#main-content").width()-this.detail_paddingLeft;$("#detail-content").width(a)},getWindowSize:function(){var e=$(window).width(),i=$(window).height();return{w:e,h:i}},getSideW:function(){return $("#aside").outerWidth()}},Mo.Frame.controller={mainFrameTag:"main-frame",detailFrameTag:"detail-frame",showHideTime:200,init:function(){this.initEvent()},initEvent:function(){var e=this;$("#e-bn-fold").click(function(){e.hideDetail()})},initUrlFilter:function(){this.mainUrlFilter(),this.detailUrlFilter()},mainUrlFilter:function(){var e=this;$(document).on("click","a[target='"+this.mainFrameTag+"']",function(){var i=$(this).attr("href");return i&&e.setMainFrame(i),!1})},detailUrlFilter:function(){var e=this;$(document).on("click","a[target='"+this.detailFrameTag+"']",function(){var i=$(this).attr("href");return i&&e.setDetailFrame(i,Mo.Frame.detail_paddingTop,Mo.Frame.detail_paddingLeft),!1})},fiterFrameURL:function(e){return"#"==e?!1:e},setMainFrame:function(e){e=this.fiterFrameURL(e),e&&($("#main-frame")[0].src=e),this.hideDetail()},setDetailFrame:function(e,i,t){e=this.fiterFrameURL(e),e&&($("#detail-frame")[0].src=e,this.showDetail(i,t))},getMainFrame:function(){return $("#main-frame")[0]},getDetailFrame:function(){return $("#detail-frame")[0]},callMainFrameFn:function(e){var i=this.getMainFrame().contentWindow;"function"==typeof i[e]&&i[e]()},callDetailFrameFn:function(e){var i=this.getDetailFrame().contentWindow;"function"==typeof i[e]&&i[e]()},showDetail:function(e,i){e=e||Mo.Frame.detail_paddingTop,i=i||Mo.Frame.detail_paddingLeft,(Mo.Frame.detail_paddingTop!=e||Mo.Frame.detail_paddingLeft!=i)&&this.setDetailSize(e,i),$("#detail-content").is(":visible")||$("#detail-content").stop(!0,!0).show().css("left",$("#inner-main").width()).animate({left:i},this.showHideTime)},setDetailSize:function(e,i){Mo.Frame.detail_paddingTop=e||Mo.Frame.default_detail_paddingTop,Mo.Frame.detail_paddingLeft=i||Mo.Frame.default_detail_paddingLeft,Mo.Frame.setSize()},hideDetail:function(){$("#detail-content").stop(!0,!0).animate({left:$("#inner-main").width()},this.showHideTime,function(){$(this).hide(),$("#detail-frame")[0].src="about:blank"})}},Mo.Frame.nav={init:function(){this.initEvent()},initEvent:function(){$(document).bind("click",function(e){var i=$(e.target);0==i.closest(".setting").length&&0==i.closest(".setting-list").length&&$(".setting-list","#header").hide()}),$(".setting","#header").bind("click",function(){$(".setting-list","#header").show()})}},$.namespace("Mo.Frame.aside"),Mo.Frame.aside={init:function(){this.initEvent()},initEvent:function(){var e=this;$(".aside-menu").on("click",".menu h3",function(){var e=$(this).parent(".menu");if(!e.hasClass(".selected")){$(".aside-menu .menu.selected").removeClass("selected"),e.addClass("selected");var i=$("li:first",e);i.click(),i.find("a").click()}}),$(".aside-menu").on("click",".menu li",function(){e.selectedLi($(this))})},selectedLi:function(e){e.hasClass(".selected")||($(".aside-menu li.selected").removeClass("selected"),e.addClass("selected"))}},$.namespace("Mo.Home"),Mo.Home={init:function(){Mo.Frame.init(),Mo.Frame.controller.init(),Mo.Frame.controller.initUrlFilter(),Mo.Frame.nav.init(),Mo.Frame.aside.init(),Mo.Home.asideMenu.init(),Mo.Home.modifyUser.init(),Mo.Home.modifyPassword.init(),Mo.Home.exit.init(),Mo.Home.about.init()}},Mo.Home.asideMenu={init:function(){this.initMenu(),this.initEvent()},initMenu:function(){for(var e=Mo.Menu.allMenus,i="",t=this.getRootMenus(e),o=t.length,a=0;o>a;a++){var n=this.getSubMenus(e,t[a].id),r=n.length;if(i+='<div class="menu">',i+="<h3><span>"+t[a].name+"</span><s>"+r+"</s></h3>",i+="<ul>",r>0)for(var s=0;r>s;s++)i+='<li><a href="'+Mo.Base.getAppUrl()+n[s].url+'" target="main-frame">'+n[s].name+"</a></li>";i+="</ul>",i+="</div>"}$("#divAsideMenu").html(i)},initEvent:function(){},getRootMenus:function(e){return this.getSubMenus(e,Mo.Menu.rootMenuId)},getSubMenus:function(e,i){var t=[],o=e.length;if(o>0)for(var a=0;o>a;a++)e[a].parentId==i&&(t[t.length]=e[a]);return t},loadMainFrame:function(e){Mo.Frame.controller.hideDetail(),Mo.Frame.controller.setMainFrame(Mo.Config.appUrl+e)}},Mo.Home.modifyUser={init:function(){this.initEvent()},initEvent:function(){var e=this;$("#modifyUser").bind("click",function(){$.dialog({padding:0,id:"modifyUserWindow",lock:!0,opacity:.5,content:document.getElementById("modifyUserWrapper"),close:function(){e.hideMsg(),$("#account").val($("#oldAccount").val()),$("#mobile").val($("#oldMobile").val()),$("#email").val($("#oldEmail").val()),$("#officeLocation").val($("#oldOfficeLocation").val())},cancel:!1,drag:!1})}),$(".confirm","#modifyUserWrapper").bind("click",function(){e.hideMsg();var i=e.checkData();return 0==i?!1:($.ajax({type:"post",url:Mo.Base.getAppUrl()+"/system/user/updateUser",data:i,dataType:"json",success:function(i){i.success&&($("#oldAccount").val($("#account").val()),$("#oldMobile").val($("#mobile").val()),$("#oldEmail").val($("#email").val()),$("#oldOfficeLocation").val($("#officeLocation").val())),e.showMsg(i.description)},error:function(){e.showMsg("修改个人资料失败，请与系统管理员联系！")}}),void 0)}),$(".W_close","#modifyUserWrapper").bind("click",function(){e.close()}),$(".cancel","#modifyUserWrapper").bind("click",function(){e.close()})},close:function(){$.dialog({id:"modifyUserWindow"}).close()},checkData:function(){var e={account:$("#account").val(),mobile:$("#mobile").val(),email:$("#email").val(),officeLocation:$("#officeLocation").val()};return""==$.trim(e.account)?(this.showMsg("请输入账号。"),$("#account").focus(),!1):""==$.trim(e.mobile)?(this.showMsg("请输入联系电话。"),$("#mobile").focus(),!1):""==$.trim(e.email)?(this.showMsg("请输入Email。"),$("#email").focus(),!1):""==$.trim(e.officeLocation)?(this.showMsg("请输入联系地址。"),$("#officeLocation").focus(),!1):e},showMsg:function(e){$(".msg","#modifyUserWrapper").text(e),$(".item-msg","#modifyUserWrapper").show()},hideMsg:function(){$(".item-msg","#modifyUserWrapper").hide(),$(".msg","#modifyUserWrapper").text("")}},Mo.Home.modifyPassword={init:function(){this.initEvent()},initEvent:function(){var e=this;$("#modifyPassword").bind("click",function(){$.dialog({padding:0,id:"modifyPasswordWindow",lock:!0,opacity:.5,title:"修改密码",content:document.getElementById("modifyPasswordWrapper"),close:function(){$("#oldPassword").val(""),$("#newPassword").val(""),$("#confirmPassword").val(""),e.hideMsg()},cancel:!1,drag:!1})}),$(".confirm","#modifyPasswordWrapper").bind("click",function(){e.hideMsg();var i=e.checkData();return 0==i?!1:($.ajax({type:"post",url:Mo.Base.getAppUrl()+"/system/user/updatePassword",data:i,dataType:"json",success:function(i){e.showMsg(i.description)},error:function(){}}),void 0)}),$(".W_close","#modifyPasswordWrapper").bind("click",function(){e.close()}),$(".cancel","#modifyPasswordWrapper").bind("click",function(){e.close()})},close:function(){$.dialog({id:"modifyPasswordWindow"}).close()},checkData:function(){var e={moid:"kedacom",oldPassword:$("#oldPassword").val(),newPassword:$("#newPassword").val(),confirmPassword:$("#confirmPassword").val()};return""==$.trim(e.oldPassword)?(this.showMsg("当前密码不能为空，请输入当前密码。"),$("#oldPassword").focus(),!1):""==$.trim(e.newPassword)?(this.showMsg("新密码不能为空，请输入新密码。"),$("#newPassword").focus(),!1):e.newPassword.length<6||e.newPassword.length>16?(this.showMsg("新密码不符合要求！"),$("#newPassword").focus(),!1):$.trim(e.oldPassword)==$.trim(e.newPassword)?(this.showMsg("新密码不能与旧密码一致"),$("#newPassword").focus(),!1):$.trim(e.newPassword)!=$.trim(e.confirmPassword)?(this.showMsg("两次输入密码不一致，请重新输入。"),$("#confirmPassword").focus(),!1):e},showMsg:function(e){$(".msg","#modifyPasswordWrapper").text(e),$(".item-msg","#modifyPasswordWrapper").show()},hideMsg:function(){$(".item-msg","#modifyPasswordWrapper").hide(),$(".msg","#modifyPasswordWrapper").text("")}},Mo.Home.exit={init:function(){this.initEvent()},initEvent:function(){var e=this;$(".logout","#header").bind("click",function(){$.dialog({padding:0,id:"logoutWindow",content:document.getElementById("logoutWrapper"),lock:!0,opacity:.5,cancel:!1,drag:!1})}),$(".W_close","#logoutWrapper").bind("click",function(){e.close()}),$(".cancel","#logoutWrapper").bind("click",function(){e.close()}),$(".confirm","#logoutWrapper").bind("click",function(){return location.href=Mo.Base.getAppUrl()+"/logout",!1})},close:function(){$.dialog({id:"logoutWindow"}).close()}},Mo.Home.about={init:function(){this.initEvent()},initEvent:function(){var e=this;$("#about").bind("click",function(){$.dialog({padding:0,id:"aboutWindow",content:document.getElementById("aboutWrapper"),lock:!0,opacity:.5,cancel:!1,drag:!1})}),$(".W_close","#aboutWrapper").bind("click",function(){e.close()})},close:function(){$.dialog({id:"aboutWindow"}).close()}};
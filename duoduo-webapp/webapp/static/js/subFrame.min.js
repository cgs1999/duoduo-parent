$.namespace("Mo.SubFrame"),Mo.SubFrame={init:function(){this.isIframe(),this.setSize(),this.initEvent(),Mo.SubFrame.controller.init()},isIframe:function(){return top.location===self.location?!1:!0},initEvent:function(){var i=this;$(window).resize(function(){i.setSize()})},getWindowSize:function(){var i=$(window).width(),e=$(window).height();return{w:i,h:e}},setSize:function(){if(!this.isEasyUI()){var i=this.getWindowSize(),e=$(".detail-btn").outerHeight();$(".detail-body").height(i.h-e)}},isEasyUI:function(){return $(".easyui-layout")[0]},getPageSize:function(){return 14}},Mo.SubFrame.controller={superFrame:window.parent&&window.parent.Mo.Frame.controller,init:function(){this.initUrlFilter()},initUrlFilter:function(){this.mainUrlFilter(),this.detailUrlFilter()},mainUrlFilter:function(){var i=this.superFrame;$(document).on("click","a[target='"+i.mainFrameTag+"']",function(){var e=$(this).attr("href");return e&&i.setMainFrame(e),!1})},detailUrlFilter:function(){var i=this;$(document).on("click","a[target='"+this.detailFrameTag+"']",function(){var e=$(this).attr("href");return e&&i.setDetailFrame(e),!1})},setMainFrame:function(i){this.superFrame.setMainFrame(i)},setDetailFrame:function(i,e,t){this.superFrame.setDetailFrame(i,e,t)},showDetail:function(i,e){this.superFrame.showDetail(i,e)},hideDetail:function(){this.superFrame.hideDetail()},setDetailSize:function(i,e){this.superFrame.setDetailSize(i,e)},getMainFrame:function(){return this.superFrame.getMainFrame()},getDetailFrame:function(){return this.superFrame.getMainFrame()},callMainFrameFn:function(i){this.superFrame.callMainFrameFn(i)},callDetailFrameFn:function(i){this.superFrame.callDetailFrameFn(i)}},$.namespace("Mo.gridDetail"),Mo.gridDetail={baseUrl:"",gridPageSize:Mo.SubFrame.getPageSize(),datagridId:"#data-grid",datagridOptions:null,treegridId:"#data-grid",treegridOptions:null,treeId:"#mytree",treeOptions:null,init:function(i){this.initOptions(i),this.initPage(),this.initHint(".input-text")},initOptions:function(i){this.initDefaultDatagridOptions(i),this.initDefaultTreegridOptions(i),this.initDefaultTreeOptions(i),$.extend(!0,this,i)},initDefaultDatagridOptions:function(i){if(i&&i.datagridOptions){var e={datagridOptions:{idField:"id",toolbar:"#tb",rownumbers:!0,striped:!1,singleSelect:!0,border:!1,fit:!0,fitColumns:!0,showHeader:!0,pagination:!0,pageSize:this.gridPageSize,pageList:[this.gridPageSize],loadMsg:"正在加载，请稍候...",onBeforeLoad:function(i){i.start=(i.page-1)*i.rows,i.limit=i.rows},onClickRow:function(i,e){var t=$(this).datagrid("options").idField;Mo.gridDetail.doOpen(e[t])}}};$.extend(!0,this,e)}},initDefaultTreegridOptions:function(i){if(i&&i.treegridOptions){var e={treegridOptions:{idField:"id",toolbar:"#tb",rownumbers:!0,striped:!1,singleSelect:!0,border:!1,fit:!0,fitColumns:!0,showHeader:!0,loadMsg:"正在加载，请稍候...",onClickRow:function(i){var e=$(this).treegrid("options").idField;Mo.gridDetail.doOpen(i[e])}}};$.extend(!0,this,e)}},initDefaultTreeOptions:function(i){if(i&&i.treeOptions){var e={treeOptions:{formatter:function(i){var e=i.text;return e}}};$.extend(!0,this,e)}},initPage:function(){this.initTree(),this.initDatagrid(),this.initTreegrid()},initTree:function(){this.treeOptions&&$(this.treeId).tree(this.treeOptions)},initDatagrid:function(){this.datagridOptions&&($(this.datagridId).datagrid(this.datagridOptions),this.datagridOptions.pagination&&this.initPagination($(this.datagridId).datagrid("getPager")))},initTreegrid:function(){this.treegridOptions&&($(this.treegridId).treegrid(this.treegridOptions),this.treegridOptions.pagination&&this.initPagination($(this.treegridId).treegrid("getPager")))},initPagination:function(i){i.pagination({layout:["manual","prev","next"],displayMsg:"当前共有 {total} 条记录",beforePageText:"",afterPageText:"/ {pages}"})},initHint:function(i){$(i).each(function(){$(this).val($(this).attr("mo-hint"))}).blur(function(){$(this).removeClass("active");var i=$(this).val(),e=$(this).attr("mo-hint");""==i&&$(this).val(e)}).focus(function(){$(this).addClass("active");var i=$(this).val(),e=$(this).attr("mo-hint");i==e&&$(this).val("")}).keydown(function(i){return 13==i.keyCode?($.isFunction(window.doSearch)&&doSearch(),!1):void 0})},getMoInputVal:function(i){var e=$(i).attr("mo-hint");return e?$(i).val()!=e?$(i).val():"":$(i).val()},getUrl:function(i){if(!this.baseUrl)return i;var e=this.baseUrl.charAt(this.baseUrl.length-1);return"/"==e?this.baseUrl.substring(0,this.baseUrl.length-1)+i:this.baseUrl+i},doOpen:function(i){Mo.SubFrame.controller.setDetailFrame(this.getUrl("/read/"+i))},reinit:function(i){this.datagridOptions=null,this.initOptions(i),this.initDatagrid(),this.initHint(".input-text")},load:function(){Mo.SubFrame.controller.hideDetail(),$(this.datagridId).datagrid("load")},reload:function(){Mo.SubFrame.controller.hideDetail(),$(this.datagridId).datagrid("reload")},loadTreegrid:function(){Mo.SubFrame.controller.hideDetail(),$(this.treegridId).treegrid("load")},reloadTreegrid:function(){Mo.SubFrame.controller.hideDetail(),$(this.treegridId).treegrid("reload")}};